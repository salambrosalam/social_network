{"ast":null,"code":"import { usersAPI } from \"../api/api\";\nconst FOLLOW = \"FOLLOW\";\nconst UNFOLLOW = \"UNFOLLOW\";\nconst SET_USERS = \"SET_USERS\";\nconst SET_CURRENT_PAGE = \"SET_CURRENT_PAGE\";\nconst SET_USERS_TOTAL_COUNT = \"SET_USERS_TOTAL_COUNT\";\nconst TOGGLE_IS_FETCHING = \"TOGGLE_IS_FETCHING\";\nconst TOGGLE_IS_FOLLOW_PROGRESS = \"TOGGLE_IS_FOLLOW_PROGRESS\";\nconst initialState = {\n  users: [],\n  pageSize: 5,\n  totalUsersCount: 19,\n  currentPage: 2,\n  isFetching: true,\n  followingInProgress: [],\n  pagePortionSize: 10\n};\n\nconst usersReducer = (state = initialState, action) => {\n  switch (action.type) {\n    case FOLLOW:\n      return { ...state,\n        users: state.users.map(user => {\n          if (user.id === action.userId) {\n            return { ...user,\n              followed: true\n            };\n          }\n\n          return user;\n        })\n      };\n\n    case UNFOLLOW:\n      return { ...state,\n        users: state.users.map(user => {\n          if (user.id === action.userId) {\n            return { ...user,\n              followed: false\n            };\n          }\n\n          return user;\n        })\n      };\n\n    case SET_USERS:\n      return { ...state,\n        users: action.users\n      };\n\n    case SET_CURRENT_PAGE:\n      return { ...state,\n        currentPage: action.currentPage\n      };\n\n    case SET_USERS_TOTAL_COUNT:\n      return { ...state,\n        totalUsersCount: action.totalUsersCount\n      };\n\n    case TOGGLE_IS_FETCHING:\n      return { ...state,\n        isFetching: action.isFetching\n      };\n\n    case TOGGLE_IS_FOLLOW_PROGRESS:\n      return { ...state,\n        followingInProgress: action.isFetching ? [...state.followingInProgress, action.userId] : state.followingInProgress.filter(id => id != action.userId)\n      };\n\n    default:\n      return state;\n  }\n};\n\nexport const followActionCreator = userId => {\n  return {\n    type: FOLLOW,\n    userId: userId\n  };\n};\nexport const unfollowActionCreator = userId => {\n  return {\n    type: UNFOLLOW,\n    userId: userId\n  };\n};\nexport const setUsersActionCreator = users => {\n  return {\n    type: SET_USERS,\n    users: users\n  };\n};\nexport const setCurrentPageActionCreator = pageNumber => {\n  return {\n    type: SET_CURRENT_PAGE,\n    currentPage: pageNumber\n  };\n};\nexport const setTotalUsersCountActionCreator = totalCount => {\n  return {\n    type: SET_USERS_TOTAL_COUNT,\n    totalUsersCount: totalCount\n  };\n};\nexport const toggleFollowingProgressActionCreator = (isFetching, userId) => {\n  return {\n    type: TOGGLE_IS_FOLLOW_PROGRESS,\n    isFetching: isFetching,\n    userId: userId\n  };\n};\nexport const setIsFetchingActionCreator = isFetching => {\n  return {\n    type: TOGGLE_IS_FETCHING,\n    isFetching: isFetching\n  };\n};\nexport const getUsersThunkCreator = (currentPage, pageSize) => {\n  return async dispatch => {\n    dispatch(setIsFetchingActionCreator(true));\n    dispatch(setCurrentPageActionCreator(currentPage));\n    let response = await usersAPI.getUsers(currentPage, pageSize);\n    dispatch(setIsFetchingActionCreator(false));\n    dispatch(setUsersActionCreator(response.data.items));\n    dispatch(setTotalUsersCountActionCreator(response.data.totalCount));\n  };\n};\nexport const followThunkCreator = userId => {\n  return async dispatch => {\n    dispatch(toggleFollowingProgressActionCreator(true, userId));\n    let response = await usersAPI.followUsers(userId);\n\n    if (response.data.resultCode === 0) {\n      dispatch(followActionCreator(userId));\n    }\n\n    dispatch(toggleFollowingProgressActionCreator(false, userId));\n  };\n};\nexport const UNfollowThunkCreator = userId => {\n  return async dispatch => {\n    dispatch(toggleFollowingProgressActionCreator(true, userId));\n    let response = await usersAPI.UNfollowUsers(userId);\n\n    if (response.data.resultCode === 0) {\n      dispatch(unfollowActionCreator(userId));\n    }\n\n    dispatch(toggleFollowingProgressActionCreator(false, userId));\n  };\n};\nexport default usersReducer;","map":{"version":3,"sources":["E:/react_projects/it-kamasutra/src/redux/usersReducer.js"],"names":["usersAPI","FOLLOW","UNFOLLOW","SET_USERS","SET_CURRENT_PAGE","SET_USERS_TOTAL_COUNT","TOGGLE_IS_FETCHING","TOGGLE_IS_FOLLOW_PROGRESS","initialState","users","pageSize","totalUsersCount","currentPage","isFetching","followingInProgress","pagePortionSize","usersReducer","state","action","type","map","user","id","userId","followed","filter","followActionCreator","unfollowActionCreator","setUsersActionCreator","setCurrentPageActionCreator","pageNumber","setTotalUsersCountActionCreator","totalCount","toggleFollowingProgressActionCreator","setIsFetchingActionCreator","getUsersThunkCreator","dispatch","response","getUsers","data","items","followThunkCreator","followUsers","resultCode","UNfollowThunkCreator","UNfollowUsers"],"mappings":"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","sourcesContent":["import {usersAPI} from \"../api/api\";\r\n\r\nconst FOLLOW = \"FOLLOW\";\r\nconst UNFOLLOW = \"UNFOLLOW\";\r\nconst SET_USERS = \"SET_USERS\";\r\nconst SET_CURRENT_PAGE = \"SET_CURRENT_PAGE\";\r\nconst SET_USERS_TOTAL_COUNT = \"SET_USERS_TOTAL_COUNT\";\r\nconst TOGGLE_IS_FETCHING = \"TOGGLE_IS_FETCHING\";\r\nconst TOGGLE_IS_FOLLOW_PROGRESS = \"TOGGLE_IS_FOLLOW_PROGRESS\"\r\n\r\nconst initialState = {\r\n    users: [\r\n    ],\r\n    pageSize: 5,\r\n    totalUsersCount: 19,\r\n    currentPage: 2,\r\n    isFetching: true,\r\n    followingInProgress: [],\r\n    pagePortionSize: 10\r\n}\r\n\r\nconst usersReducer = (state = initialState, action) => {\r\n    switch (action.type){\r\n        case FOLLOW:\r\n            return {\r\n                ...state,\r\n                users: state.users.map((user) => {\r\n                    if (user.id === action.userId){\r\n                        return {...user,followed:true}\r\n                    }\r\n                    return(\r\n                    user\r\n                    )\r\n                })\r\n\r\n            }\r\n        case UNFOLLOW:\r\n            return {\r\n                ...state,\r\n                users: state.users.map((user) => {\r\n                    if (user.id === action.userId){\r\n                        return {...user,followed:false}\r\n                    }\r\n                    return(\r\n                        user\r\n                    )\r\n                })\r\n\r\n            }\r\n        case SET_USERS:\r\n            return{\r\n                ...state, users: action.users\r\n            }\r\n        case SET_CURRENT_PAGE:\r\n            return{\r\n                ...state, currentPage: action.currentPage\r\n            }\r\n        case SET_USERS_TOTAL_COUNT:\r\n            return{\r\n                ...state, totalUsersCount: action.totalUsersCount\r\n            }\r\n        case TOGGLE_IS_FETCHING:\r\n            return{\r\n                ...state, isFetching: action.isFetching\r\n            }\r\n        case TOGGLE_IS_FOLLOW_PROGRESS:\r\n            return {\r\n                ...state,\r\n                followingInProgress: action.isFetching ?\r\n                    [...state.followingInProgress, action.userId] :\r\n                    state.followingInProgress.filter(id => id != action.userId)\r\n            }\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport const followActionCreator = (userId) => {\r\n    return {\r\n        type: FOLLOW,\r\n        userId: userId\r\n    }\r\n}\r\n\r\nexport const unfollowActionCreator = (userId) => {\r\n    return {\r\n        type: UNFOLLOW,\r\n        userId: userId\r\n    }\r\n}\r\n\r\nexport const setUsersActionCreator = (users) => {\r\n    return {\r\n        type: SET_USERS,\r\n        users: users\r\n    }\r\n}\r\nexport const setCurrentPageActionCreator = (pageNumber) =>{\r\n    return {\r\n        type: SET_CURRENT_PAGE,\r\n        currentPage: pageNumber\r\n    }\r\n}\r\n\r\nexport const setTotalUsersCountActionCreator = (totalCount) => {\r\n    return {\r\n        type: SET_USERS_TOTAL_COUNT,\r\n        totalUsersCount: totalCount\r\n    }\r\n}\r\n\r\nexport const toggleFollowingProgressActionCreator = (isFetching, userId) => {\r\n    return {\r\n        type: TOGGLE_IS_FOLLOW_PROGRESS,\r\n        isFetching: isFetching,\r\n        userId: userId\r\n    }\r\n}\r\n\r\nexport const setIsFetchingActionCreator = (isFetching) => {\r\n    return {\r\n        type: TOGGLE_IS_FETCHING,\r\n        isFetching: isFetching\r\n    }\r\n}\r\n\r\nexport const getUsersThunkCreator = (currentPage, pageSize) => {\r\n    return async (dispatch) => {\r\n        dispatch(setIsFetchingActionCreator(true));\r\n        dispatch(setCurrentPageActionCreator(currentPage))\r\n        let response = await usersAPI.getUsers(currentPage, pageSize)\r\n            dispatch(setIsFetchingActionCreator(false));\r\n            dispatch(setUsersActionCreator(response.data.items));\r\n            dispatch(setTotalUsersCountActionCreator(response.data.totalCount))\r\n    }\r\n}\r\n\r\nexport const followThunkCreator = (userId) => {\r\n    return async (dispatch) => {\r\n        dispatch(toggleFollowingProgressActionCreator(true, userId));\r\n        let response = await usersAPI.followUsers(userId)\r\n            if (response.data.resultCode === 0) {\r\n                dispatch(followActionCreator(userId));\r\n            }\r\n            dispatch(toggleFollowingProgressActionCreator(false, userId));\r\n    }\r\n}\r\n\r\nexport const UNfollowThunkCreator = (userId) => {\r\n    return async (dispatch) => {\r\n        dispatch(toggleFollowingProgressActionCreator(true, userId));\r\n        let response = await usersAPI.UNfollowUsers(userId)\r\n            if (response.data.resultCode === 0) {\r\n                dispatch(unfollowActionCreator(userId));\r\n            }\r\n            dispatch(toggleFollowingProgressActionCreator(false, userId));\r\n    }\r\n}\r\n\r\n\r\nexport default usersReducer;"]},"metadata":{},"sourceType":"module"}