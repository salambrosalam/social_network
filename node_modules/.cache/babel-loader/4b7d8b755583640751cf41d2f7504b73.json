{"ast":null,"code":"import _regeneratorRuntime from\"E:\\\\react_projects\\\\it-kamasutra\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"E:\\\\react_projects\\\\it-kamasutra\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"E:\\\\react_projects\\\\it-kamasutra\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"E:\\\\react_projects\\\\it-kamasutra\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import{usersAPI}from\"../api/api\";var FOLLOW=\"FOLLOW\";var UNFOLLOW=\"UNFOLLOW\";var SET_USERS=\"SET_USERS\";var SET_CURRENT_PAGE=\"SET_CURRENT_PAGE\";var SET_USERS_TOTAL_COUNT=\"SET_USERS_TOTAL_COUNT\";var TOGGLE_IS_FETCHING=\"TOGGLE_IS_FETCHING\";var TOGGLE_IS_FOLLOW_PROGRESS=\"TOGGLE_IS_FOLLOW_PROGRESS\";var initialState={users:[],pageSize:5,totalUsersCount:19,currentPage:2,isFetching:true,followingInProgress:[],pagePortionSize:10};var usersReducer=function usersReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case FOLLOW:return _objectSpread(_objectSpread({},state),{},{users:state.users.map(function(user){if(user.id===action.userId){return _objectSpread(_objectSpread({},user),{},{followed:true});}return user;})});case UNFOLLOW:return _objectSpread(_objectSpread({},state),{},{users:state.users.map(function(user){if(user.id===action.userId){return _objectSpread(_objectSpread({},user),{},{followed:false});}return user;})});case SET_USERS:return _objectSpread(_objectSpread({},state),{},{users:action.users});case SET_CURRENT_PAGE:return _objectSpread(_objectSpread({},state),{},{currentPage:action.currentPage});case SET_USERS_TOTAL_COUNT:return _objectSpread(_objectSpread({},state),{},{totalUsersCount:action.totalUsersCount});case TOGGLE_IS_FETCHING:return _objectSpread(_objectSpread({},state),{},{isFetching:action.isFetching});case TOGGLE_IS_FOLLOW_PROGRESS:return _objectSpread(_objectSpread({},state),{},{followingInProgress:action.isFetching?[].concat(_toConsumableArray(state.followingInProgress),[action.userId]):state.followingInProgress.filter(function(id){return id!=action.userId;})});default:return state;}};export var followActionCreator=function followActionCreator(userId){return{type:FOLLOW,userId:userId};};export var unfollowActionCreator=function unfollowActionCreator(userId){return{type:UNFOLLOW,userId:userId};};export var setUsersActionCreator=function setUsersActionCreator(users){return{type:SET_USERS,users:users};};export var setCurrentPageActionCreator=function setCurrentPageActionCreator(pageNumber){return{type:SET_CURRENT_PAGE,currentPage:pageNumber};};export var setTotalUsersCountActionCreator=function setTotalUsersCountActionCreator(totalCount){return{type:SET_USERS_TOTAL_COUNT,totalUsersCount:totalCount};};export var toggleFollowingProgressActionCreator=function toggleFollowingProgressActionCreator(isFetching,userId){return{type:TOGGLE_IS_FOLLOW_PROGRESS,isFetching:isFetching,userId:userId};};export var setIsFetchingActionCreator=function setIsFetchingActionCreator(isFetching){return{type:TOGGLE_IS_FETCHING,isFetching:isFetching};};export var getUsersThunkCreator=function getUsersThunkCreator(currentPage,pageSize){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(setIsFetchingActionCreator(true));dispatch(setCurrentPageActionCreator(currentPage));_context.next=4;return usersAPI.getUsers(currentPage,pageSize);case 4:response=_context.sent;dispatch(setIsFetchingActionCreator(false));dispatch(setUsersActionCreator(response.data.items));dispatch(setTotalUsersCountActionCreator(response.data.totalCount));case 8:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var followThunkCreator=function followThunkCreator(userId){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(toggleFollowingProgressActionCreator(true,userId));_context2.next=3;return usersAPI.followUsers(userId);case 3:response=_context2.sent;if(response.data.resultCode===0){dispatch(followActionCreator(userId));}dispatch(toggleFollowingProgressActionCreator(false,userId));case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var UNfollowThunkCreator=function UNfollowThunkCreator(userId){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:dispatch(toggleFollowingProgressActionCreator(true,userId));_context3.next=3;return usersAPI.UNfollowUsers(userId);case 3:response=_context3.sent;if(response.data.resultCode===0){dispatch(unfollowActionCreator(userId));}dispatch(toggleFollowingProgressActionCreator(false,userId));case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export default usersReducer;","map":{"version":3,"sources":["E:/react_projects/it-kamasutra/src/redux/usersReducer.js"],"names":["usersAPI","FOLLOW","UNFOLLOW","SET_USERS","SET_CURRENT_PAGE","SET_USERS_TOTAL_COUNT","TOGGLE_IS_FETCHING","TOGGLE_IS_FOLLOW_PROGRESS","initialState","users","pageSize","totalUsersCount","currentPage","isFetching","followingInProgress","pagePortionSize","usersReducer","state","action","type","map","user","id","userId","followed","filter","followActionCreator","unfollowActionCreator","setUsersActionCreator","setCurrentPageActionCreator","pageNumber","setTotalUsersCountActionCreator","totalCount","toggleFollowingProgressActionCreator","setIsFetchingActionCreator","getUsersThunkCreator","dispatch","getUsers","response","data","items","followThunkCreator","followUsers","resultCode","UNfollowThunkCreator","UNfollowUsers"],"mappings":"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","sourcesContent":["import {usersAPI} from \"../api/api\";\r\n\r\nconst FOLLOW = \"FOLLOW\";\r\nconst UNFOLLOW = \"UNFOLLOW\";\r\nconst SET_USERS = \"SET_USERS\";\r\nconst SET_CURRENT_PAGE = \"SET_CURRENT_PAGE\";\r\nconst SET_USERS_TOTAL_COUNT = \"SET_USERS_TOTAL_COUNT\";\r\nconst TOGGLE_IS_FETCHING = \"TOGGLE_IS_FETCHING\";\r\nconst TOGGLE_IS_FOLLOW_PROGRESS = \"TOGGLE_IS_FOLLOW_PROGRESS\"\r\n\r\nconst initialState = {\r\n    users: [\r\n    ],\r\n    pageSize: 5,\r\n    totalUsersCount: 19,\r\n    currentPage: 2,\r\n    isFetching: true,\r\n    followingInProgress: [],\r\n    pagePortionSize: 10\r\n}\r\n\r\nconst usersReducer = (state = initialState, action) => {\r\n    switch (action.type){\r\n        case FOLLOW:\r\n            return {\r\n                ...state,\r\n                users: state.users.map((user) => {\r\n                    if (user.id === action.userId){\r\n                        return {...user,followed:true}\r\n                    }\r\n                    return(\r\n                    user\r\n                    )\r\n                })\r\n\r\n            }\r\n        case UNFOLLOW:\r\n            return {\r\n                ...state,\r\n                users: state.users.map((user) => {\r\n                    if (user.id === action.userId){\r\n                        return {...user,followed:false}\r\n                    }\r\n                    return(\r\n                        user\r\n                    )\r\n                })\r\n\r\n            }\r\n        case SET_USERS:\r\n            return{\r\n                ...state, users: action.users\r\n            }\r\n        case SET_CURRENT_PAGE:\r\n            return{\r\n                ...state, currentPage: action.currentPage\r\n            }\r\n        case SET_USERS_TOTAL_COUNT:\r\n            return{\r\n                ...state, totalUsersCount: action.totalUsersCount\r\n            }\r\n        case TOGGLE_IS_FETCHING:\r\n            return{\r\n                ...state, isFetching: action.isFetching\r\n            }\r\n        case TOGGLE_IS_FOLLOW_PROGRESS:\r\n            return {\r\n                ...state,\r\n                followingInProgress: action.isFetching ?\r\n                    [...state.followingInProgress, action.userId] :\r\n                    state.followingInProgress.filter(id => id != action.userId)\r\n            }\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport const followActionCreator = (userId) => {\r\n    return {\r\n        type: FOLLOW,\r\n        userId: userId\r\n    }\r\n}\r\n\r\nexport const unfollowActionCreator = (userId) => {\r\n    return {\r\n        type: UNFOLLOW,\r\n        userId: userId\r\n    }\r\n}\r\n\r\nexport const setUsersActionCreator = (users) => {\r\n    return {\r\n        type: SET_USERS,\r\n        users: users\r\n    }\r\n}\r\nexport const setCurrentPageActionCreator = (pageNumber) =>{\r\n    return {\r\n        type: SET_CURRENT_PAGE,\r\n        currentPage: pageNumber\r\n    }\r\n}\r\n\r\nexport const setTotalUsersCountActionCreator = (totalCount) => {\r\n    return {\r\n        type: SET_USERS_TOTAL_COUNT,\r\n        totalUsersCount: totalCount\r\n    }\r\n}\r\n\r\nexport const toggleFollowingProgressActionCreator = (isFetching, userId) => {\r\n    return {\r\n        type: TOGGLE_IS_FOLLOW_PROGRESS,\r\n        isFetching: isFetching,\r\n        userId: userId\r\n    }\r\n}\r\n\r\nexport const setIsFetchingActionCreator = (isFetching) => {\r\n    return {\r\n        type: TOGGLE_IS_FETCHING,\r\n        isFetching: isFetching\r\n    }\r\n}\r\n\r\nexport const getUsersThunkCreator = (currentPage, pageSize) => {\r\n    return async (dispatch) => {\r\n        dispatch(setIsFetchingActionCreator(true));\r\n        dispatch(setCurrentPageActionCreator(currentPage))\r\n        let response = await usersAPI.getUsers(currentPage, pageSize)\r\n            dispatch(setIsFetchingActionCreator(false));\r\n            dispatch(setUsersActionCreator(response.data.items));\r\n            dispatch(setTotalUsersCountActionCreator(response.data.totalCount))\r\n    }\r\n}\r\n\r\nexport const followThunkCreator = (userId) => {\r\n    return async (dispatch) => {\r\n        dispatch(toggleFollowingProgressActionCreator(true, userId));\r\n        let response = await usersAPI.followUsers(userId)\r\n            if (response.data.resultCode === 0) {\r\n                dispatch(followActionCreator(userId));\r\n            }\r\n            dispatch(toggleFollowingProgressActionCreator(false, userId));\r\n    }\r\n}\r\n\r\nexport const UNfollowThunkCreator = (userId) => {\r\n    return async (dispatch) => {\r\n        dispatch(toggleFollowingProgressActionCreator(true, userId));\r\n        let response = await usersAPI.UNfollowUsers(userId)\r\n            if (response.data.resultCode === 0) {\r\n                dispatch(unfollowActionCreator(userId));\r\n            }\r\n            dispatch(toggleFollowingProgressActionCreator(false, userId));\r\n    }\r\n}\r\n\r\n\r\nexport default usersReducer;"]},"metadata":{},"sourceType":"module"}